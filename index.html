<!DOCTYPE html>
<html lang="en">

    <head>
        <title>York Lab App</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <!--<meta name="theme-color" content="#db5945">-->
        <link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png">
        <link rel="icon" type="image/png" sizes="192x192" href="/images/android-icon-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
        <link rel="manifest" href="/manifest.json">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png">
        <script src="https://apis.google.com/js/api.js"></script>
        <link rel="stylesheet" href="css/style.css" />
    </head>

    <body ng-app="YorkResourcesApp" ng-controller="ApplicationController">
        <!-------------------------------------------------------->
        <!-------------- The Welcome/Login screen ---------------->
        <div id="overlay_background" class="overlay-background">
            <div id="welcome_dialog">
                <div class="signin-dialog-padding">
                    <h1 style="margin-top:-6px">Welcome</h1>
                    <!--<img src="images/logo.png" style="width: 50%;margin: auto;margin-top: 30px;">-->
                    <p>Sign in with your me@york.org email account.</p>
                    <div class="signin-button-container">
                        <div id="signin_button" class="signin-button">
                            <div class="signin-icon"><svg style="" viewBox="0, 0, 40, 40">
                            <path d="M 22,20 h15 a17,17 0 1,1 -8,-14" fill="none" stroke="#4885ed" stroke-width="8"></path>
                        </svg></div>
                            <p class="signin-text">Sign in</p>
                        </div>
                        <md-progress-circular id="signin_spinner" class="md-accent" md-mode="indeterminate" md-diameter="36"></md-progress-circular>
                        <md-button style="display:none" id="dat_button" ng-click="::gotoRoute({classPath:'/Memes'})">meme</md-button>
                    </div>
                </div>
                <div class="signin-dialog-tip">
                    <h3>Tips:</h3>
                    <p>Look for the mobile update comming soon.</p>
                    <!--<md-button ng-click="openOnboardingDialog()">onboard</md-button>-->
                </div>
            </div>
        </div>
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.1/angular-material.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css" media="none" onload="if(media!='all')media='all'">
        <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700,400italic|Roboto+Mono|Roboto+Slab|Material+Icons" rel="stylesheet" media="none" onload="if(media!='all')media='all'">
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.js"></script>
        <!-------------------------------------------------------->
        <!------------------- The top toolbar -------------------->
        <md-toolbar toolbar-top-content class="md-whiteframe-z2 ng-cloak toolbar-top" ng-class="{'rainbow' : queryParams.classpath == 'meme' }"></md-toolbar>
        <!-------------------------------------------------------->
        <!-------------------------------------------------------->
        <div class="horizontalContainer" ng-cloak>
            <!---------------------------------------------------->
            <md-sidenav side-nav-insides class="side-nav md-sidenav-left md-whiteframe-z2 sidenav-overlay" md-component-id="sidenav_overlay"></md-sidenav>
            <side-nav-insides class="side-nav md-sidenav-left sidenav-inline" ng-class="{'side-nav-open' : globals.sidenavIsOpen === true && $mdMedia('gt-sm'),'rainbow2' : queryParams.classpath == 'meme', 'xs': $mdMedia('xs'), 'sm': $mdMedia('sm')}"></side-nav-insides>
            <!----- The content, ie posts, resources, etc. ------->
            <md-fab-speed-dial id="speed_dial_container" md-direction="up" md-open="globals.FABisOpen" ng-class="{ 'slide-out' : globals.FABisHidden }" class="md-fling md-hover-full md-fab-bottom-right" ng-mouseenter="globals.FABisOpen = true" ng-mouseleave="globals.FABisOpen = false">
                <md-fab-trigger>
                    <md-button id="new_post_button" class="md-fab md-accent raise-on-hover" ng-click="FABClick($event)">
                        <md-tooltip md-direction="left" md-autohide>Add Resource</md-tooltip>
                        <md-icon class="unselectable">add</md-icon>
                    </md-button>
                </md-fab-trigger>
                <md-fab-actions>
                    <md-button class="md-fab md-raised md-mini" ng-click="::showPicker('Drive')">
                        <md-tooltip md-direction="left" md-autohide>Add Drive file</md-tooltip>
                        <img class="unselectable" style="width:22px; height:22px; margin-top:8px" src="images/drive_icon.svg">
                    </md-button>
                    <md-button class="md-fab md-raised md-mini">
                        <label class="custom-file-upload" style=>
                    <input type="file" accept="image/*" capture="camera" style="display:none"/>
                    <md-tooltip md-direction="left" md-autohide>Take Photo</md-tooltip>
                    <md-icon class="unselectable" style="color:black">camera</md-icon>
                        </label>
                    </md-button>
                    <md-button class="md-fab md-raised md-mini" ng-click="::showPicker('Upload')">
                        <md-tooltip md-direction="left" md-autohide>Upload</md-tooltip>
                        <md-icon class="unselectable" style="color:black">file_upload</md-icon>
                    </md-button>
                </md-fab-actions>
            </md-fab-speed-dial>
            <div id="content_container" ng-class="{'xs': $mdMedia('xs'), 'sm': $mdMedia('sm'), 'ugly-brown' : queryParams.classpath == 'meme' , 'gt-sm': $mdMedia('gt-sm')}">
                <span ng-show="devMode">
                        <md-button ng-click="consoleLog(myInfo, true)">
                            Log My Info
                        </md-button>
                        <md-button ng-click="consoleLog({'string': queryPropertyString, 'properties':queryProperties}, true)">
                            Log Search Query string
                        </md-button>
                        <md-button ng-click="logDuplicationIndexes()">
                            Log page & deduplication Indexes
                        </md-button>
                        <md-button ng-click="consoleLog({queryParam: queryParam, query: queryParam.q, classParam: classParam, selectedClass: selectedClass, idParam: idParam}, true)">
                            Log URL Paramiters
                        </md-button>
                        <md-button ng-click="consoleLog(visiblePosts)">
                            Log Visible Posts Array
                        </md-button>
                        <md-button ng-click="consoleLog(allPosts)">
                            Log All Posts Array
                        </md-button>
                        <md-button ng-click="refreshLayout()">
                            Refresh Layout
                        </md-button>
                        all: {{allPosts.length}} Visible: {{visiblePosts.length}}
                </span>
                <div class="new-post-bar-top">
                    <span md-ink-ripple="true" class="new-post-text-top unselectable" flex ng-click="::newPost({},'new')">
                        <md-icon style="margin-top: -3px;">add_circle</md-icon>
                        <span>Share a link or resource...</span>
                    </span>
                    <span class="new-post-option-button" ng-click="::showPicker('Upload')">
                        <md-tooltip md-direction="::down">Upload</md-tooltip>
                        <md-icon class="unselectable" style="color: black;">file_upload</md-icon>
                    </span>
                    <span class="new-post-option-button" ng-click="::showPicker('Drive')">
                        <md-tooltip md-direction="::down">Add Drive file</md-tooltip>
                        <md-icon class="unselectable" md-svg-icon="driveIcon"></md-icon>
                    </span>
                </div>
                <div>
                    <div angular-grid="visiblePosts" id="layout_grid" ag-gutter-size="" angular-grid-id="postsGrid" refreshOnImgLoad="false" ag-scroll-container="#content_container" ag-infinite-scroll="getFiles()">
                        <div ng-repeat="Post in visiblePosts track by Post.Id" ng-style="{'background-color': Post.Class.Color}" class="post-card raise-on-hover">
                            <div class="post-card-header" md-ink-ripple="{{Post.Link != ''}}" ng-class="{'no-link': Post.Link == '', 'gDrive-type': Post.Type == 'gDrive'}" ng-click="openLink(Post.Link)">
                                <img ng-src="{{Post.PreviewImage}}" class="post-card-image" ng-hide="Post.Link == ''"></img>
                                <div class="image-gradient-overlay">
                                    <div class="gradient-overlay-metadata metadata-regular">
                                        <span ng-hide="Post.Class.Name == null"><md-icon>people</md-icon> {{Post.Class.Name}}</span>
                                        <span><md-icon>event</md-icon> {{Post.CreationDate | date : "mm/dd/yyyy"}}</span>
                                    </div>
                                    <div ng-hide="Post.Tags.length < 1" class="gradient-overlay-metadata metadata-regular">
                                        <span><md-icon>style</md-icon> {{Post.Tags.join(', ')}}</span>
                                    </div>
                                    <div ng-hide="Post.Link == '' || Post.Type == 'gDrive'" class="gradient-overlay-metadata metadata-link" style="font-size:18px">
                                        <span><md-icon>language</md-icon> {{removeHttp(Post.Link)}}</span>
                                    </div>
                                    <div class="gradient-overlay-metadata md-chips metadata-link" ng-hide="Post.Type != 'gDrive'" style="width:100%">
                                        <md-chip>
                                            <div class="md-chip-content">
                                                <img ng-src="{{Post.AttachmentIcon}}" style="margin-right:4px"></img>
                                                <span>{{Post.AttachmentName}}</span>
                                            </div>
                                        </md-chip>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <p class="post-card-title md-title">{{Post.Title}}</p>
                                <p class="post-card-creator md-subhead"><span>By {{::Post.Creator.Name}}</span><span style="float:right">(<md-icon class="small-icon">school</md-icon> {{::Post.Creator.ClassOf}})</span></p>
                                <p id="post_card_description" class="md-body-1" ng-bind-html="Post.Description" ng-hide="Post.Description === ''"></p>
                                <md-card-actions layout="row" style="align-items: center;">
                                    <md-button id="like_thumb_button" aria-label="Like" ng-click="likePost(Post)">
                                        <span class="like-counter">{{Post.Likes.length}}</span>
                                        <md-icon ng-class="{'md-accent' : Post.userLiked}" style="margin-top: -8px">thumb_up</md-icon>
                                    </md-button>
                                    <md-button class="md-icon-button" area-label="Flag" ng-click="::unFlagPost(Post,$index)" ng-hide="Post.Flagged == false">
                                        <md-icon class="md-warn">flag</md-icon>
                                    </md-button>
                                    <md-button class="md-icon-button" area-label="Flag" ng-click="::flagPost(Post,$index)" ng-hide="Post.Creator.Email === myInfo.Email || Post.Flagged == true">
                                        <md-icon>flag</md-icon>
                                    </md-button>
                                    <md-menu>
                                        <md-button ng-click="::$mdOpenMenu($event)" ng-show="::Post.Creator.Email === myInfo.Email" class="md-icon-button">
                                            <md-icon>more_vert</md-icon>
                                        </md-button>
                                        <md-menu-content>
                                            <md-menu-item ng-hide="::Post.Flagged === true">
                                                <md-button ng-click="flagPost(Post,$index)">
                                                    <md-icon>flag</md-icon>Flag</md-button>
                                            </md-menu-item>
                                            <md-menu-item>
                                                <md-button ng-click="::confirmDelete(Post,$index)">
                                                    <md-icon>delete</md-icon>Delete</md-button>
                                            </md-menu-item>
                                            <md-menu-item>
                                                <md-button ng-click="newPost(Post,'update')">
                                                    <md-icon>edit</md-icon>Edit</md-button>
                                            </md-menu-item>
                                            <md-menu-item ng-show="devMode">
                                                <md-button ng-click="::logPostToConsole(Post,$index)">
                                                    <md-icon>edit</md-icon>Console Log Post</md-button>
                                            </md-menu-item>
                                        </md-menu-content>
                                    </md-menu>
                                    <span flex></span>
                                    <md-button id="open_button" ng-hide="::Post.Description == ''" class="md-button md-accent" ng-click="newPost(Post, 'view')" aria-label="Open resource">View</md-button>
                                </md-card-actions>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer-container">
                    <div class="footer">
                        <div id="no_posts_footer" style="display: none;">
                            <h3 style="margin: 0;">It's so lonely here</h3>
                            <p style="margin: 0;font-size: 14px;font-weight: 200;">Be the first to post</p>
                            <img src="images/Lonely Island.png" style="width: 216px; padding-top: 12px;" />
                        </div>
                        <div id="no_more_footer" style="display: none;">
                            <h3 style="margin: 0;">No more posts? Has everyone gone to sleep?</h3>
                            <p style="margin: 0;font-size: 14px;font-weight: 200;">Maybe you should Contribute.</p>
                            <img src="images/Lonely Island.png" style="width: 216px; padding-top: 12px;" />
                        </div>
                        <div id="footer_problem" style="display: none; align-items: center;">
                            <div style="margin-right:-120px;margin-left: 120px;z-index:1;margin-top: 20px;">
                                <h3 style="margin: 0; text-shadow: 0px 0px 10px rgb(242, 242, 242);">Houston, we have a problem!</h3>
                                <p style="margin: 0;font-size: 14px;font-weight: 200;">Something's not quite right, try
                                    <md-button class="md-accent md-raised">Reloading</md-button>
                                    <p>
                            </div>
                            <img src="images/rocket problem.png" style="width:300px" />
                        </div>
                        <md-progress-circular id="loading_spinner" style="display: none;margin: auto;" class="md-accent" md-mode="indeterminate" md-diameter="30px"></md-progress-circular>
                    </div>
                </div>
            </div>
            <!-------------------------------------------------------->
            <!---------------------- Libraries ----------------------->
            <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.1/angular-material.min.js"></script>
            <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular-animate.min.js"></script>
            <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular-aria.min.js"></script>
            <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular-messages.min.js"></script>
            <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular-route.js"></script>
            <script src="Libraries/ng-sanitize-1.5.7.js"></script>
            <script src="Libraries/angular-grid.js"></script>
            <script type="text/javascript" src="Libraries/detect-element-resize.js"></script>


            <!-- Main Scripts -->
            <script src="js/app.js"></script>
            <script src="js/generalFunctions.js"></script>

            <!-- Directives -->
            <script src="directives/directives.js"></script>

            <!-- Services -->
            <script src="js/Services/authorizationService.js"></script>
            <script src="js/Services/googleDriveService.js"></script>

            <!-- Controllers -->
            <script src="js/Controllers/mainControllerFunctions.js"></script>
            <script src="js/Controllers/subControllerFunctions.js"></script>
            <script src="js/Controllers/newPostController.js"></script>

            <!--<canvas style="display:none;position: absolute;pointer-events: none;" width="400" height="260" id="image_renderer">-->
    </body>
    <link rel="stylesheet" href="css/toolbarTop.css" />
    <link rel="stylesheet" href="css/searchbar.css" />
    <link rel="stylesheet" href="css/sideNav.css" />
    <link rel="stylesheet" href="css/postCard.css" />
    <link rel="stylesheet" href="css/newPost.css" />
    <link rel="stylesheet" href="css/help.css" />

</html>
